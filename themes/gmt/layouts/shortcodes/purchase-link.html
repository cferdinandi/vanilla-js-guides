{{- $data := getJSON $.Site.Params.api -}}

{{- $product := index $.Site.Data.products ( .Get "product" ) -}}
{{- $.Scratch.Set "price" $data.products.guides -}}
{{- $.Scratch.Set "type" "guides-individual" -}}
{{- if .Get "bundle" -}}
	{{- if eq ( .Get "bundle" ) "complete" -}}
		{{- $.Scratch.Set "price" $data.products.guidesComplete -}}
		{{- $.Scratch.Set "type" "guides-complete" -}}
	{{- else if eq ( .Get "bundle" ) "fundamentals" -}}
		{{- $.Scratch.Set "price" $data.products.guidesFundamentals -}}
		{{- $.Scratch.Set "type" "guides-fundamentals" -}}
	{{- else if eq ( .Get "bundle" ) "levelup" -}}
		{{- $.Scratch.Set "price" $data.products.guidesLevelup -}}
		{{- $.Scratch.Set "type" "guides-levelup" -}}
	{{- end -}}
{{- end -}}
{{- $price := ( $.Scratch.Get "price" ) -}}

{{- $apiPrices := index $data "prices" -}}
{{- $.Scratch.Set "apiPrice" "" -}}
{{- if isset $apiPrices ($.Scratch.Get "type") -}}
	{{- $.Scratch.Set "apiPrice" (index $apiPrices ($.Scratch.Get "type")) -}}
{{- end -}}
{{- $apiPrice := $.Scratch.Get "apiPrice" -}}

{{- $.Scratch.Set "apiDiscount" "" -}}
{{- if and (ne (.Scratch.Get "apiPrice") "") (isset (.Scratch.Get "apiPrice") "discount") -}}
	{{- .Scratch.Set "apiDiscount" (index (.Scratch.Get "apiPrice") "discount") -}}
{{- end -}}

<p><mark><svg width="1.4em" height="0.8em" viewBox="0 0 192 110" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><g fill="currentColor" fill-rule="nonzero" aria-hidden="true"><path d="M116.419 10.118c17.418 9.344 22.832 14.164 39.184 31.781 8.957 9.645 15.18 13.957 28.508 18.164 6.715 2.121 9.832 9.836 6.473 16.027-14.055 25.867-47.938 41.246-86.766 29.203-2.603-.806-12.416-4.149-12.914-4.324l-.016-.006.012.003.03.01c-14.226-4.753-23.847-6.609-33.093-5.581-7.282.812-13.734 3.543-19.707 8.714-7.813 6.758-19.832.235-18.422-10l9.969-72.285a11.173 11.173 0 0 1 4.269-7.351c2.586-1.989 6.918-4.664 12.793-7.274V7.2c21.105-9.363 45.164-10.23 69.68 2.918ZM90 17c-3.542 0-6.552 1.24-9.031 3.719-2.48 2.479-3.719 5.49-3.719 9.031 0 2.79.797 5.268 2.39 7.438 1.522 2.07 3.447 3.556 5.775 4.457l.335.125L73 46.75V51h12.75v25.168a28.421 28.421 0 0 1-6.11-1.727 38.754 38.754 0 0 1-5.677-2.822A41.372 41.372 0 0 1 68.883 68a47.923 47.923 0 0 1-4.383-3.984V55.25H56v4.25c0 2.125.974 4.648 2.922 7.57 1.948 2.922 4.516 5.711 7.703 8.368 3.188 2.656 6.818 4.914 10.89 6.773C81.59 84.07 85.75 85 90 85s8.411-.93 12.484-2.79c4.073-1.858 7.704-4.116 10.891-6.772 3.188-2.657 5.755-5.446 7.703-8.368 1.948-2.922 2.922-5.445 2.922-7.57v-4.25h-8.5v8.766A47.923 47.923 0 0 1 111.117 68a41.372 41.372 0 0 1-5.08 3.62 38.754 38.754 0 0 1-5.678 2.821 28.421 28.421 0 0 1-6.109 1.727V51H107v-4.25l-12.75-4.98c2.48-.886 4.516-2.413 6.11-4.583 1.593-2.169 2.39-4.648 2.39-7.437 0-3.542-1.24-6.552-3.719-9.031C96.552 18.239 93.541 17 90 17Zm.5 8c1.266 0 2.332.434 3.2 1.3.866.868 1.3 1.934 1.3 3.2 0 1.266-.434 2.332-1.3 3.2-.868.866-1.934 1.3-3.2 1.3-1.266 0-2.332-.434-3.2-1.3-.866-.868-1.3-1.934-1.3-3.2 0-1.266.434-2.332 1.3-3.2.868-.866 1.934-1.3 3.2-1.3ZM12.92 13.645a6 6 0 0 1 11.905 1.483l-.028.223-12.858 89.502A6 6 0 0 1 .033 103.37l.028-.223 12.858-89.502Z"></path></g></svg> <em><strong>Get access to everything this {{ if .Get "bundle" }}bundle{{ else }}guide{{ end }} and more for just $9/month!</strong> <a href="https://leanwebclub.com">Join the Lean Web Club</a>, a growing collection of short, opinionated tutorials and projects on how to build things for the web with HTML, CSS, vanilla JS, and more. <a href="https://leanwebclub.com">Start here for free.</a></em></mark></p>

<p class="margin-bottom-small"><a class="btn btn-large btn-block edd-buy-now-button" href='https://gomakethings.com/checkout?edd_action=add_to_cart&download_id={{ $product.id }}&edd_options[price_id]=3{{ if ne (.Scratch.Get "apiDiscount") "" }}&discount={{ .Scratch.Get "apiDiscount" }}{{ end }}&ref={{ "https://vanillajsguides.com" | urlquery }}'><strong>Best Value:</strong> Ebook{{ if .Get "bundle" }}s{{ end }} + Videos - {{ if ne $apiPrice "" }}{{ index $apiPrice "both" | safeHTML }}{{ else }}{{ $price.both | safeHTML }}{{ end }}</a></p>
<div class="row">
	<div class="grid-half margin-bottom-small">
		<a class="btn btn-tertiary btn-large btn-block edd-buy-now-button" href='https://gomakethings.com/checkout?edd_action=add_to_cart&download_id={{ $product.id }}&edd_options[price_id]=2{{ if ne (.Scratch.Get "apiDiscount") "" }}&discount={{ .Scratch.Get "apiDiscount" }}{{ end }}&ref={{ "https://vanillajsguides.com" | urlquery }}'>Just the Videos - {{ if ne $apiPrice "" }}{{ index $apiPrice "video" | safeHTML }}{{ else }}{{ $price.video | safeHTML }}{{ end }}</a>
	</div>
	<div class="grid-half margin-bottom-medium">
		<a class="btn btn-secondary btn-large btn-block edd-buy-now-button" href='https://gomakethings.com/checkout?edd_action=add_to_cart&download_id={{ $product.id }}&edd_options[price_id]=1{{ if ne (.Scratch.Get "apiDiscount") "" }}&discount={{ .Scratch.Get "apiDiscount" }}{{ end }}&ref={{ "https://vanillajsguides.com" | urlquery }}'>Just the Ebook{{ if .Get "bundle" }}s{{ end }} - {{ if ne $apiPrice "" }}{{ index $apiPrice "ebook" | safeHTML }}{{ else }}{{ $price.ebook | safeHTML }}{{ end }}</a>
	</div>
</div>

{{- if .Get "bundle" -}}
<details class="text-center margin-bottom">
	<summary class="margin-bottom-small">Or make three monthly payments...</summary>
	<ul class="list-unstyled">
		<li><a class="edd-buy-now-button" href='https://gomakethings.com/checkout?edd_action=add_to_cart&download_id={{ $product.monthly }}&edd_options[price_id]=3{{ if ne (.Scratch.Get "apiDiscount") "" }}&discount={{ .Scratch.Get "apiDiscount" }}{{ end }}&ref={{ "https://vanillajsguides.com" | urlquery }}'>Ebooks + Video Series - {{ if ne $apiPrice "" }}{{ index $apiPrice "bothMonthly" | safeHTML }}{{ else }}{{ $price.bothMonthly | safeHTML }}{{ end }}</a></li>
		<li><a class="edd-buy-now-button" href='https://gomakethings.com/checkout?edd_action=add_to_cart&download_id={{ $product.monthly }}&edd_options[price_id]=2{{ if ne (.Scratch.Get "apiDiscount") "" }}&discount={{ .Scratch.Get "apiDiscount" }}{{ end }}&ref={{ "https://vanillajsguides.com" | urlquery }}'>Video Series - {{ if ne $apiPrice "" }}{{ index $apiPrice "videoMonthly" | safeHTML }}{{ else }}{{ $price.videoMonthly | safeHTML }}{{ end }}</a></li>
		<li><a class="edd-buy-now-button" href='https://gomakethings.com/checkout?edd_action=add_to_cart&download_id={{ $product.monthly }}&edd_options[price_id]=1{{ if ne (.Scratch.Get "apiDiscount") "" }}&discount={{ .Scratch.Get "apiDiscount" }}{{ end }}&ref={{ "https://vanillajsguides.com" | urlquery }}'>Ebooks - {{ if ne $apiPrice "" }}{{ index $apiPrice "ebookMonthly" | safeHTML }}{{ else }}{{ $price.ebookMonthly | safeHTML }}{{ end }}</a></li>
	</ul>
</details>
{{- end -}}